
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><title>Python: module bee4lan_svc</title>
<meta charset="utf-8">
</head><body bgcolor="#f0f0f8">

<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="heading">
<tr bgcolor="#7799ee">
<td valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial">&nbsp;<br><big><big><strong>bee4lan_svc</strong></big></big></font></td
><td align=right valign=bottom
><font color="#ffffff" face="helvetica, arial"><a href=".">index</a><br><a href="file:///R:/bee4lan/install/bee4lan_svc.py">r:\bee4lan\install\bee4lan_svc.py</a></font></td></tr></table>
    <p><tt>#&nbsp;-*-&nbsp;coding:&nbsp;utf-8&nbsp;-*-&nbsp;<br>
#&nbsp;<a href="http://stackoverflow.com/questions/8943371/cant-start-windows-service-written-in-python-win32serviceutil">http://stackoverflow.com/questions/8943371/cant-start-windows-service-written-in-python-win32serviceutil</a><br>
#&nbsp;Inspiration&nbsp;and&nbsp;supercision:&nbsp;Mgr.&nbsp;Filip&nbsp;Vaculik&nbsp;-&nbsp;Mintaka</tt></p>
<p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#aa55cc">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Modules</strong></big></font></td></tr>
    
<tr><td bgcolor="#aa55cc"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><table width="100%" summary="list"><tr><td width="25%" valign=top><a href="logging.html">logging</a><br>
<a href="os.html">os</a><br>
<a href="subprocess.html">subprocess</a><br>
</td><td width="25%" valign=top><a href="sys.html">sys</a><br>
<a href="time.html">time</a><br>
<a href="win32api.html">win32api</a><br>
</td><td width="25%" valign=top><a href="win32event.html">win32event</a><br>
<a href="win32service.html">win32service</a><br>
<a href="win32serviceutil.html">win32serviceutil</a><br>
</td><td width="25%" valign=top></td></tr></table></td></tr></table><p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#ee77aa">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Classes</strong></big></font></td></tr>
    
<tr><td bgcolor="#ee77aa"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><dl>
<dt><font face="helvetica, arial"><a href="win32serviceutil.html#ServiceFramework">win32serviceutil.ServiceFramework</a>
</font></dt><dd>
<dl>
<dt><font face="helvetica, arial"><a href="bee4lan_svc.html#Bee4lan">Bee4lan</a>
</font></dt></dl>
</dd>
</dl>
 <p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#ffc8d8">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#000000" face="helvetica, arial"><a name="Bee4lan">class <strong>Bee4lan</strong></a>(<a href="win32serviceutil.html#ServiceFramework">win32serviceutil.ServiceFramework</a>)</font></td></tr>
    
<tr bgcolor="#ffc8d8"><td rowspan=2><tt>&nbsp;&nbsp;&nbsp;</tt></td>
<td colspan=2><tt><a href="#Bee4lan">Bee4lan</a>&nbsp;CLASS.<br>&nbsp;</tt></td></tr>
<tr><td>&nbsp;</td>
<td width="100%">Methods defined here:<br>
<dl><dt><a name="Bee4lan-SvcRun"><strong>SvcRun</strong></a>(self)</dt><dd><tt>Main&nbsp;function&nbsp;with&nbsp;the&nbsp;infinite&nbsp;loop&nbsp;containing&nbsp;all&nbsp;the&nbsp;functionality&nbsp;performed&nbsp;by&nbsp;this&nbsp;service.</tt></dd></dl>

<dl><dt><a name="Bee4lan-SvcStop"><strong>SvcStop</strong></a>(self)</dt><dd><tt>Enables&nbsp;this&nbsp;service&nbsp;to&nbsp;stop&nbsp;from&nbsp;Windows&nbsp;API.</tt></dd></dl>

<dl><dt><a name="Bee4lan-__init__"><strong>__init__</strong></a>(self, *args)</dt><dd><tt>Init&nbsp;function&nbsp;of&nbsp;this&nbsp;class.</tt></dd></dl>

<dl><dt><a name="Bee4lan-checkTasks"><strong>checkTasks</strong></a>(self)</dt><dd><tt>Check&nbsp;if&nbsp;there&nbsp;is&nbsp;a&nbsp;task&nbsp;on&nbsp;the&nbsp;server&nbsp;to&nbsp;be&nbsp;done.</tt></dd></dl>

<dl><dt><a name="Bee4lan-checkTimeChanges"><strong>checkTimeChanges</strong></a>(self)</dt><dd><tt>Firstly&nbsp;look&nbsp;at&nbsp;time&nbsp;changes&nbsp;of&nbsp;control.cfg.&nbsp;If&nbsp;any&nbsp;were&nbsp;done,&nbsp;you&nbsp;<br>
don't&nbsp;have&nbsp;to&nbsp;do&nbsp;anything&nbsp;else.<br>
This&nbsp;should&nbsp;save&nbsp;some&nbsp;system&nbsp;resources...<br>
Works&nbsp;since&nbsp;second&nbsp;try&nbsp;from&nbsp;launching&nbsp;the&nbsp;service&nbsp;or&nbsp;from&nbsp;making&nbsp;the&nbsp;task.&nbsp;<br>
This&nbsp;behavior&nbsp;is&nbsp;normal.</tt></dd></dl>

<dl><dt><a name="Bee4lan-compareNums"><strong>compareNums</strong></a>(self)</dt><dd><tt>Return&nbsp;True&nbsp;if&nbsp;current&nbsp;task&nbsp;has&nbsp;not&nbsp;been&nbsp;performed&nbsp;yet.</tt></dd></dl>

<dl><dt><a name="Bee4lan-launchWithoutConsole"><strong>launchWithoutConsole</strong></a>(self, command, args)</dt><dd><tt>Launches&nbsp;'command'&nbsp;windowless.&nbsp;Usefull&nbsp;when&nbsp;we&nbsp;do&nbsp;something&nbsp;<br>
what&nbsp;doesn't&nbsp;need&nbsp;any&nbsp;interaction&nbsp;from&nbsp;user&nbsp;and&nbsp;it&nbsp;is&nbsp;required&nbsp;to&nbsp;not&nbsp;<br>
obstruct&nbsp;user&nbsp;during&nbsp;his&nbsp;work.<br>
SYSTEM&nbsp;=&nbsp;the&nbsp;default&nbsp;user&nbsp;managing&nbsp;bee4lan&nbsp;service&nbsp;and&nbsp;also&nbsp;launching&nbsp;our&nbsp;scripts&nbsp;on&nbsp;clients.</tt></dd></dl>

<dl><dt><a name="Bee4lan-logGlobal"><strong>logGlobal</strong></a>(self, message)</dt><dd><tt>Logging&nbsp;function&nbsp;to&nbsp;log&nbsp;on&nbsp;the&nbsp;server.</tt></dd></dl>

<dl><dt><a name="Bee4lan-logLocal"><strong>logLocal</strong></a>(self, message)</dt><dd><tt>Logging&nbsp;function&nbsp;to&nbsp;log&nbsp;localy.</tt></dd></dl>

<dl><dt><a name="Bee4lan-mountDrives"><strong>mountDrives</strong></a>(self)</dt><dd><tt>Mount&nbsp;network&nbsp;drives&nbsp;needed&nbsp;by&nbsp;this&nbsp;service&nbsp;(SYSTEM&nbsp;account)&nbsp;to&nbsp;work.</tt></dd></dl>

<dl><dt><a name="Bee4lan-readReqHostsAndTaskNumber"><strong>readReqHostsAndTaskNumber</strong></a>(self)</dt><dd><tt>Read&nbsp;a&nbsp;lists&nbsp;of&nbsp;hosts&nbsp;from&nbsp;server,&nbsp;who&nbsp;are&nbsp;intended&nbsp;to&nbsp;perform&nbsp;the&nbsp;task&nbsp;<br>
and&nbsp;store&nbsp;this&nbsp;information&nbsp;in&nbsp;the&nbsp;REQ_HOSTS&nbsp;class&nbsp;list.</tt></dd></dl>

<dl><dt><a name="Bee4lan-startScript"><strong>startScript</strong></a>(self, command, start_state<font color="#909090">='SW_SHOWNORMAL'</font>)</dt><dd><tt>Launches&nbsp;command&nbsp;with&nbsp;its&nbsp;visible&nbsp;window.&nbsp;Usefull&nbsp;when&nbsp;we&nbsp;do&nbsp;something&nbsp;<br>
for&nbsp;user&nbsp;and&nbsp;need&nbsp;his&nbsp;interaction.&nbsp;<br>
Set&nbsp;status&nbsp;for&nbsp;new&nbsp;window.&nbsp;See&nbsp;end&nbsp;of&nbsp;script&nbsp;or:<br>
https://msdn.microsoft.com/en-us/library/ms633548</tt></dd></dl>

<hr>
Methods inherited from <a href="win32serviceutil.html#ServiceFramework">win32serviceutil.ServiceFramework</a>:<br>
<dl><dt><a name="Bee4lan-GetAcceptedControls"><strong>GetAcceptedControls</strong></a>(self)</dt></dl>

<dl><dt><a name="Bee4lan-ReportServiceStatus"><strong>ReportServiceStatus</strong></a>(self, serviceStatus, waitHint<font color="#909090">=5000</font>, win32ExitCode<font color="#909090">=0</font>, svcExitCode<font color="#909090">=0</font>)</dt></dl>

<dl><dt><a name="Bee4lan-ServiceCtrlHandler"><strong>ServiceCtrlHandler</strong></a>(self, control)</dt></dl>

<dl><dt><a name="Bee4lan-ServiceCtrlHandlerEx"><strong>ServiceCtrlHandlerEx</strong></a>(self, control, event_type, data)</dt></dl>

<dl><dt><a name="Bee4lan-SvcInterrogate"><strong>SvcInterrogate</strong></a>(self)</dt></dl>

<dl><dt><a name="Bee4lan-SvcOther"><strong>SvcOther</strong></a>(self, control)</dt></dl>

<dl><dt><a name="Bee4lan-SvcOtherEx"><strong>SvcOtherEx</strong></a>(self, control, event_type, data)</dt><dd><tt>#&nbsp;The&nbsp;'Ex'&nbsp;functions,&nbsp;which&nbsp;take&nbsp;additional&nbsp;params</tt></dd></dl>

</td></tr></table></td></tr></table>
</body></html>